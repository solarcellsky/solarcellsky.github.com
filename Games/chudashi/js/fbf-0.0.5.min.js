;
(function(b, f) {
    f.FBF = function(a, e) {
        this.$element = b(a);
        this.$fbfStyle = b("<style></style>");
        var c = {
            width: b(a).width(),
            height: b(a).height(),
            img: "",
            frames: 0,
            speed: 100,
            loop: !1,
            start: 0,
            end: "null"
        };
        this.options = b.extend({}, c, e);
        b("head").append(this.$fbfStyle);
        this.init()
    };
    FBF.prototype = {
        init: function() {
            var a = this,
                e = this.options,
                c = b(new Image);
            this.$fbfImg = c;
            this.ready = !1;
            c.one("load", function() {
                a.ready || a.imgReady()
            });
            c[0].src = e.img
        },
        imgReady: function() {
            this.ready = !0;
            var a = this.options,
                b = this.$fbfImg;
            this.$element.css({
                "-webkit-animation": "none",
                width: a.width + "px",
                height: a.height + "px",
                background: 'url("' + b[0].src + '") 0 0 no-repeat',
                "background-size": "auto 100%"
            });
            a.frames = a.frames || b[0].width / a.width;
            "number" !== typeof a.end && (a.end = a.frames - 1)
        },
        reInit: function(a) {
            this.options = b.extend({}, this.options, a);
            this.init()
        },
        play: function(a, e) {
            function c() {
                var d = b.extend({}, g.options, a),
                    c = Math.abs(d.end - d.start);
                d.loop ? d.end += 1 : h = "normal forwards";
                f.html("@-webkit-keyframes " + k + "{0% {-webkit-transform: translate3d(0, 0, 0);background-position: " + -d.width * d.start + "px 0;}100% {-webkit-transform: translate3d(0, 0, 0);background-position: " + -d.end * d.width + "px 0;}}");
                l.css({
                    "-webkit-animation": k + " " + c * d.speed / 1E3 + "s steps(" + c + " , end) " + h
                });
                "function" === typeof e && setTimeout(e, c * d.speed)
            }
            var g = this,
                l = this.$element,
                f = this.$fbfStyle,
                m = this.$fbfImg,
                k = "f_b_f" + (new Date).getTime(),
                h = "infinite";
            l.css("-webkit-animation", "none");
            if (this.ready) c();
            else m.one("load", function() {
                g.ready || g.imgReady();
                c()
            })
        }
    }
})(jQuery, window);
