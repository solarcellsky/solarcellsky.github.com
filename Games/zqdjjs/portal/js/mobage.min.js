/*
 * Copyright 2013, DeNA, Co., Ltd. All rights reserved.
 * Proprietary and Confidential
 * Do not redistribute
 */
var mobage;
if (typeof(mobage) === "undefined") {
    mobage = {}
}
if (typeof(mobage.casualgame) === "undefined") {
    mobage.casualgame = {}
}
mobage.casualgame = {origin: "*", delegate: null, locale: "ja", DID_SHARE: "didShare", LOCALE_JAPANESE: "ja", LOCALE_ENGLISH: "en", LOCALE_KOREAN: "ko", SHARE_MESSAGE_LIMIT_COUNT: 100, totalLoaded: -1, getLocale: function () {
    var d = location.search;
    if (d != "") {
        d = d.substr(1, d.length);
        var e = d.split("&");
        for (var b in e) {
            var a = e[b].split("=")[0];
            var c = e[b].split("=")[1];
            if (a === "lang") {
                this.locale = c;
                return this.locale
            }
        }
    }
    return this.locale
}, setTotalLoadItems: function (a) {
    if (!a && a != 0) {
        return
    }
    var b = parseInt(a, 10);
    if (b < 0) {
        return
    }
    this.totalLoaded = a;
    window.parent.postMessage('{"method":"setTotalLoadItems", "value":' + a + "}", mobage.casualgame.origin)
}, setCurrentLoaded: function (b) {
    if (this.totalLoaded == -1) {
        return
    }
    if (!b && b != 0) {
        return
    }
    var a = parseInt(b, 10);
    if (a < 0) {
        return
    }
    window.parent.postMessage('{"method":"setCurrentLoaded", "value":' + b + "}", mobage.casualgame.origin)
}, readyToStartGame: function () {
    window.parent.postMessage('{"method":"readyToStartGame"}', mobage.casualgame.origin)
}, startGame: function () {
    window.parent.postMessage('{"method":"startGame"}', mobage.casualgame.origin);
	document.getElementById("toolbar").style.display="none";
}, pauseGame: function () {
    window.parent.postMessage('{"method":"pauseGame"}', mobage.casualgame.origin)
}, resumeGame: function () {
    window.parent.postMessage('{"method":"resumeGame"}', mobage.casualgame.origin)
}, finishGame: function (a, b) {
    if (a == undefined || typeof a != "number") {
        a = 0
    }
    if (b == undefined || typeof b != "number") {
        b = 0
    }
	
	//dp_submitScore(b);
	setTimeout(function(){
	document.getElementById("toolbar").style.display="block";
    window.parent.postMessage('{"method":"finishGame", "categoryId": ' + a + ', "score": ' + b + "}", mobage.casualgame.origin)
	},2000)
}, showShareWidget: function (d, c, f, e) {
	
}, hideShareWidget: function (a) {
    
}, showIncentiveWindow: function (b, a, c) {
    
}, showPromotionView: function () {
    window.parent.postMessage('{"method":"showPromotion"}', mobage.casualgame.origin)
}, hidePromotionView: function () {
    window.parent.postMessage('{"method":"hidePromotion"}', mobage.casualgame.origin)
}, getCSRFToken: function () {
    return window.parent.token
}, getUBID: function () {
    var e = document.cookie, e = e.split(" ").join(""), d = e.split(";"), a = d.length;
    for (var b = 0; b < a; b++) {
        if (d[b].split("=")[0] === "MINI_UNIQUE_BROWSER_ID") {
            return d[b].split("=")[1]
        }
    }
    return""
}};


//反馈
window.addEventListener("message", function (b) {
    var a = JSON.parse(b.data);
    console.log(a);
    switch (a.method) {
        case"shareButtonWasSelected":
            if (mobage.casualgame.delegate[mobage.casualgame.DID_SHARE]) {
                mobage.casualgame.delegate[mobage.casualgame.DID_SHARE](parseInt(a.eventId, 10), a.targetSNS)
            }
            break
    }
}, false);